# Обнаружение изменений в окружающей среде

Этот скрипт предназначен для анализа двух изображений, обнаружения изменений между ними и визуализации этих различий. Он использует **Индекс Структурного Сходства (SSIM)** из библиотеки `skimage` и библиотеку **OpenCV** для обработки изображений.

---

## Функционал

- Модель построенная на неронной сети tensorflow классифицирует объекты на классы ('AnnualCrop', 'Forest', 'HerbaceousVegetation', 'Highway', 'Industrial',
- 'Pasture', 'PermanentCrop', 'Residential', 'River', 'SeaLake')
- Далее алгоритм на основе индекса структурного сходства Сравнивает два входных изображения и вычисляет процент их сходства.
- Выделяет области изменений между двумя изображениями.
- Генерирует визуальные результаты:
  - Карта различий.
  - Бинарная маска изменений.
  - Исходные изображения с выделенными изменениями.
  - Изображение с заполненными областями изменений.

---


### Требуемые библиотеки

Убедитесь, что у вас установлены следующие библиотеки Python:

- `scikit-image`
- `opencv-python`
- `numpy`
- from kaggle_datasets
- import KaggleDatasets
- import tensorflow as tf, re, math
- import efficientnet.tfkeras as efn
- import tensorflow.keras.backend as K

Установите их с помощью pip:

```bash
pip install scikit-image opencv-python numpy
```

---

## Инструкция по использованию

1. **Подготовьте входные изображения**
   - Сохраните два изображения, которые вы хотите сравнить, в ту же директорию, что и скрипт.
   - Назовите изображения `left1.jpg` и `right1.jpg` (или измените имена файлов в коде скрипта).

2. **Запустите скрипт**
   - Выполните команду:

   ```bash
   python script_name.py
   ```

3. **Просмотр результатов**
   - Скрипт отобразит следующие результаты в отдельных окнах:
     - `Image 1 with Changes`: Первое изображение с выделенными изменениями.
     - `Image 2 with Changes`: Второе изображение с выделенными изменениями.
     - `Difference Map`: Карта различий в градациях серого.
     - `Colored Difference Map`: Цветная карта с выделенными различиями.
     - `Change Mask`: Бинарная маска обнаруженных изменений.
     - `Highlighted Changes`: Второе изображение с заполненными областями изменений.

   Нажмите любую клавишу, чтобы закрыть окна с результатами.

---

## Принцип работы

1. **Загрузка изображений**
   - Скрипт загружает два изображения и преобразует их в градации серого.

2. **Индекс структурного сходства (SSIM)**
   - Метрика SSIM сравнивает два изображения в оттенках серого и возвращает коэффициент сходства и карту различий.

3. **Обработка различий**
   - Карта различий бинаризуется, чтобы создать изображение, где изменения отмечены.
   - Контуры изменений идентифицируются и обрабатываются.

4. **Визуализация**
   - Области изменений выделяются на исходных изображениях с помощью прямоугольников и заполненных контуров.

---

## Пример результата

При сравнении двух изображений скрипт генерирует визуальные результаты, такие как:

- Прямоугольники вокруг областей изменений.
- Карта различий, показывающая изменения на уровне пикселей.
- Бинарная маска с обнаруженными изменениями.

---

## Настройка

- **Чувствительность к изменениям**: Настройте порог площади контура в скрипте:
  ```python
  if contour_area > 40:
  ```
  Увеличьте или уменьшите значение `40`, чтобы изменить чувствительность к изменениям.

- **Пути к файлам**: Измените имена файлов в скрипте, чтобы использовать пользовательские изображения:
  ```python
  img1 = cv2.imread('your_image1.jpg')
  img2 = cv2.imread('your_image2.jpg')
  ```

---

## Лицензия

Этот проект распространяется под лицензией MIT. Вы можете свободно использовать и модифицировать его для своих нужд.

---

## Благодарности

- [scikit-image](https://scikit-image.org/)
- [OpenCV](https://opencv.org/)
